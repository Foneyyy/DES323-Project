{% extends 'layout.html' %}
{%load static%}

{% block title %}
Dao Football
{% endblock %}

{% block content %}

<section class="pt-4 ps-4">
    <h1 class="title fs-3">Prediction</h1>
</section>
<section class="d-flex justify-content-center align-items-center mt-5 pt-4 gap-3 gap-md-5 ">
    <div class="text-center">
        <h3>
            Home Team
        </h3><img class="logo" src="{%static 'arsenal.png'%}" alt="" srcset="">
        <select class="form-select" aria-label="Default select example" id="home-team">
            <option value="" selected disabled>Select the team</option>
            {% for team in teams %}
            <option value="{{ team }}">{{ team }}</option>
            {% endfor %}
        </select>

    </div>
    <div>
        <h3>VS</h3>
    </div>
    <div class="text-center">
        <h3>
            Away Team
        </h3><img class="logo" src="{%static 'arsenal.png'%}" alt="" srcset="">
        <select class="form-select" aria-label="Default select example" id="away-team">
            <option value="" selected disabled>Select the team</option>
            {% for team in teams %}
            <option value="{{ team }}">{{ team }}</option>
            {% endfor %}
        </select>
    </div>

</section>
{{url}}


<script>
    document.addEventListener('DOMContentLoaded', function () {
        var homeTeamSelect = document.getElementById('home-team');
        var awayTeamSelect = document.getElementById('away-team');

        homeTeamSelect.addEventListener('change', function () {
            var selectedHomeTeam = homeTeamSelect.value;
            console.log('Selected Home Team:', selectedHomeTeam);
            // Perform further actions if needed
        });

        awayTeamSelect.addEventListener('change', function () {
            var selectedAwayTeam = awayTeamSelect.value;
            console.log('Selected Away Team:', selectedAwayTeam);
            // Perform further actions if needed
        });
    });
</script>


<div id="visual" class="mt-5"></div>
<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<script src="https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>


    async function refresh_visual() {
        let w11_api = await axios.get('https://reimagined-adventure-4pq976rxqgx37gxj-8000.app.github.dev/model/').then(function (response) {
            const data = response.data.outcome_probabilities;
            return data[0]
        })
        const data = [
            { team: "Home Win", probability: w11_api[0] },
            { team: "Away Lose", probability: w11_api[1] },
            { team: "Draw", probability: w11_api[2] },
        ];
        plot = Plot.plot({
            title: "Predicted Probability of Winning",
            ylabel: "Team",
            xlabel: "Probability",
            x: {
                axis: 'top',
                domain: [0, 1],

            },

            marks: [
                Plot.barX(data, {
                    x: "probability",
                    y: "team",
                    fill: function (d) {
                        if (d.probability * 100 > 50) {
                            return '#2CB96D';
                        } else {
                            return "#E63946";
                        }
                    },
                    label: "Predicted Probability",

                }),
                Plot.axisY({ label: null, })

            ],

        });
        document.getElementById('visual').appendChild(plot);

    }

</script>






{% endblock %}